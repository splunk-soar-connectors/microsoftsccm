<!-- 
File: readme.html

Copyright (c) Phantom Cyber Corporation, 2016

This unpublished material is proprietary to Phantom Cyber.
All rights reserved. The methods and
techniques described herein are considered trade secrets
and/or confidential. Reproduction or distribution, in whole
or in part, is forbidden except by express written permission
of Phantom Cyber Corporation.
-->

    <p>
    The Microsoft SCCM app allows the listing and installing of selected updates on a network endpoint. The app requires PowerShell on the endpoint and endpoint permissions for remote script execution.
    <br>
    </p>
    <p>
    The Microsoft SCCM uses the Phantom Agent App in order to perform the actions on the endpoint.
    </p>
    <p>The Phantom Agent is a Windows service that is remotely installed as part of the action run, and is uninstalled upon action completion.</p>
    <p>The MS SCCM App supports various Windows versions. AD policies need to be setup to allow for remote service installation of the Phantom Agent. This process is documented in a KB article on the Phantom user portal. <a href="https://my.phantom.us/kb/3">Link</a></p>
    <p>If the endpoint is not part of a domain, then it would require modifying the Windows firewall rules on the machine to enable &quot;File and Printer Sharing&quot; in the &quot;Allowed programs and features&quot; list on the &quot;Windows Firewall&quot; configuration.</p>
    <h3 id="phantom-agent-binaries">Phantom Agent Binaries</h3>
    <p>The actual service that gets installed on the Windows endpoints are Windows signed binaries that are stored on the Phantom server. Each of the service binaries (32 and 64 bit) are tagged with a certificate that represents that particular Phantom instance. So copying the binaries from one Phantom installation to another will render them unusable. This same certificate is used by the MS SCCM App in the SSL communication with the service running on the endpoint.</p>
    <h3 id="action-run">Action Run</h3>
    <p>When the user runs a Microsoft SCCM action like 'list updates' on an endpoint from a Phantom instance, it is carried out on the endpoint in the following manner:</p>
    <ul>
    <li>Install the Phantom Agent service on the endpoint and start it.</li>
    <li>On start, the service will connect back to the MS SCCM App running on the Phantom server using SSL.</li>
    <li>This connect back design does not require any additional firewall ports to be opened on the endpoint.</li>
    <li>Phantom server will then pass on the actual command that is needed to be carried out on the endpoint.</li>
    <li>The Agent will carry out the command and pass the results over the same SSL connection and close it when done.</li>
    <li>Phantom server will then proceed to uninstall the service from the endpoint.</li>
    </ul>
    <h3 id="bind-ports">Bind Ports</h3>
    <ul>
    <li>The Phantom Agent starts listening on a port on the Phantom server. This port is what the service connects back to.</li>
    <li>The Phantom IP and Port number that the Phantom Agent is listening on is configured as part of the service that is installed on the endpoint.</li>
    <li>By default, the port range used is &quot;27100-27200&quot;. However this range can be configured in the MS SCCM App configuration.</li>
    <li>Note that by default the Phantom server has a firewall turned on. The default port range has been opened up to allow Agent communication. If the range is modified in the MS SCCM App configuration, then the open port range in the firewall on the Phantom server will require re-configuration. As of this writing iptables is the firewall used on the Phantom server.</li>
    </ul>
    <br>
    </p>
