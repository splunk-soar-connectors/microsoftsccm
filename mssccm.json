{
    "appid"     : "61150a2a-b13c-4ada-92d1-b8af49c501bd",
    "name"    : "Microsoft SCCM",
    "description" : "Microsoft SCCM ",
    "publisher": "Phantom",
    "type": "endpoint",
    "main_module" : "mssccm_connector.pyc",
    "app_version": "1.0.13",
    "utctime_updated": "2017-04-29T02:31:08.000000Z",
    "package_name": "phantom_mssccm",
    "product_vendor": "Microsoft",
    "product_name": "Windows Server",
    "product_version_regex": ".*",
    "min_phantom_version": "1.2.283",
    "logo": "microsoft_logo.png",
    "app_config_render": "default",
    "license": "Copyright (c) Phantom Cyber Corporation 2016",
    "configuration": {
      "server": {
        "data_type": "string",
        "order": 0,
        "description": "Server IP/Hostname",
        "required": true
      },
      "ph": {
        "data_type": "ph",
        "order": 1
      },
      "username": {
        "data_type": "string",
        "order": 2,
        "description": "Administrator username",
        "required": true
      },
      "password": {
        "data_type": "password",
        "order": 3,
        "description": "Administrator password",
        "required": true
      }
    },
    "app_config": {
      "interface": {
        "data_type": "string",
        "order": 0,
        "description": "Network interface to listen on (e.g. eth1)",
        "verbose": "Microsoft SCCM gets installed on an endpoint and will use this interface's ip address to connect back to the Microsoft SCCM.",
        "value": "eth0",
        "required": false
      },
      "port_range": {
        "data_type": "string",
        "order": 1,
        "description": "Port range to listen on (e.g. 27100-27200)",
        "verbose": "Phantom will bind to a port in this range to wait for connection from the Microsoft SCCM.",
        "value": "27100-27200",
        "required": false
      }
    },
    "actions": [
      {
        "action": "list updates",
        "description": "List available updates on a particular endpoint",
        "verbose": "This action executes a PowerShell script using cmdlets to get the list of all available updates for a particular endpoint.",
        "type": "investigate",
        "identifier": "list_updates",
        "read_only": true,
        "lock": {
          "enabled": true,
          "data_path": "parameters.ip_hostname"
        },
        "parameters": {
          "ip_hostname": {
             "data_type": "string",
             "description": "Hostname/IP to list available updates on",
             "required": true,
             "order": 0
          }
        },
        "render": {
          "width": 12,
          "title": "Available Updates",
          "type": "table",
          "height": 5
        },
        "output": [
          {
            "column_name": "Update",
            "data_path": "action_result.data.*.Title ",
            "data_type": "string",
            "column_order": 0
          },
          {
            "column_name": "KB ID",
            "data_path": "action_result.data.*.KB",
            "data_type": "string",
            "column_order": 1,
            "contains": ["update id"]
          },
          {
            "column_name": "Priority",
            "data_path": "action_result.data.*.IsMandatory ",
            "data_type": "string",
            "column_order": 2
          },
          {
            "column_name": "Download size",
            "data_path": "action_result.data.*.Size",
            "column_order": 3,
            "data_type": "string"
          },
          {
            "data_path": "action_result.data.*.RebootRequired",
            "data_type": "string"
          },
          {
            "data_path": "action_result.id",
            "data_type": "string"
          },
          {
            "data_path": "action_result.data.*.Type",
            "data_type": "string"
          },
          {
            "data_path": "action_result.data.*.CveIDs",
            "data_type": "string"
          },
          {
            "data_path": "action_result.data.*.Image ",
            "data_type": "string"
          },
          {
            "data_path": "action_result.data.*.IsBeta",
            "data_type": "string"
          },
          {
            "data_path": "action_result.data.*.Status",
            "data_type": "string"
          },
          {
            "data_path": "action_result.data.*.Deadline",
            "data_type": "string"
          },
          {
            "data_path": "action_result.data.*.EulaText",
            "data_type": "string"
          },
          {
            "data_path": "action_result.data.*.Identity",
            "data_type": "string"
          },
          {
            "data_path": "action_result.data.*.IsHidden",
            "data_type": "string"
          },
          {
            "data_path": "action_result.data.*.PerUser ",
            "data_type": "string"
          },
          {
            "data_path": "action_result.data.*.BrowseOnly",
            "data_type": "string"
          },
          {
            "data_path": "action_result.data.*.Categories",
            "data_type": "string"
          },
          {
            "data_path": "action_result.data.*.HandlerID ",
            "data_type": "string"
          },
          {
            "data_path": "action_result.data.*.IsPresent ",
            "data_type": "string"
          },
          {
            "data_path": "action_result.data.*.Languages ",
            "data_type": "string"
          },
          {
            "data_path": "action_result.data.*.SupportUrl",
            "data_type": "string"
          },
          {
            "data_path": "action_result.data.*.AutoDownload",
            "data_type": "string"
          },
          {
            "data_path": "action_result.data.*.ComputerName",
            "data_type": "string"
          },
          {
            "data_path": "action_result.data.*.Description ",
            "data_type": "string"
          },
          {
            "data_path": "action_result.data.*.EulaAccepted",
            "data_type": "string"
          },
          {
            "data_path": "action_result.data.*.IsDownloaded",
            "data_type": "string"
          },
          {
            "data_path": "action_result.data.*.IsInstalled ",
            "data_type": "string"
          },
          {
            "data_path": "action_result.data.*.KBArticleIDs",
            "data_type": "string"
          },
          {
            "data_path": "action_result.data.*.MoreInfoUrls",
            "data_type": "string"
          },
          {
            "data_path": "action_result.data.*.MsrcSeverity",
            "data_type": "string"
          },
          {
            "data_path": "action_result.data.*.ReleaseNotes",
            "data_type": "string"
          },
          {
            "data_path": "action_result.data.*.role services",
            "data_type": "string"
          },
          {
            "data_path": "action_result.data.*.AutoSelection ",
            "data_type": "string"
          },
          {
            "data_path": "action_result.data.*.BundledUpdates",
            "data_type": "string"
          },
          {
            "data_path": "action_result.data.*.CanRequireSource",
            "data_type": "string"
          },
          {
            "data_path": "action_result.data.*.DeploymentAction",
            "data_type": "string"
          },
          {
            "data_path": "action_result.data.*.DownloadContents",
            "data_type": "string"
          },
          {
            "data_path": "action_result.data.*.DownloadPriority",
            "data_type": "string"
          },
          {
            "data_path": "action_result.data.*.IsUninstallable ",
            "data_type": "string"
          },
          {
            "data_path": "action_result.data.*.MaxDownloadSize ",
            "data_type": "string"
          },
          {
            "data_path": "action_result.data.*.MinDownloadSize ",
            "data_type": "string"
          },
          {
            "data_path": "action_result.data.*.RecommendedMemory ",
            "data_type": "string"
          },
          {
            "data_path": "action_result.data.*.AutoSelectOnWebSites",
            "data_type": "string"
          },
          {
            "data_path": "action_result.data.*.InstallationBehavior",
            "data_type": "string"
          },
          {
            "data_path": "action_result.data.*.RecommendedCpuSpeed ",
            "data_type": "string"
          },
          {
            "data_path": "action_result.data.*.SecurityBulletinIDs ",
            "data_type": "string"
          },
          {
            "data_path": "action_result.data.*.SupersededUpdateIDs ",
            "data_type": "string"
          },
          {
            "data_path": "action_result.data.*.UninstallationNotes ",
            "data_type": "string"
          },
          {
            "data_path": "action_result.data.*.UninstallationSteps ",
            "data_type": "string"
          },
          {
            "data_path": "action_result.data.*.UninstallationBehavior",
            "data_type": "string"
          },
          {
            "data_path": "action_result.data.*.LastDeploymentChangeTime",
            "data_type": "string"
          },
          {
            "data_path": "action_result.data.*.RecommendedHardDiskSpace",
            "data_type": "string"
          },
          {
            "data_path": "action_result.data.*.ollowing the role services",
            "data_type": "string"
          },
          {
            "data_path": "action_result.data.*.DeltaCompressedContentAvailable ",
            "data_type": "string"
          },
          {
            "data_path": "action_result.data.*.DeltaCompressedContentPreferred ",
            "data_type": "string"
          },
          {
            "data_path": "action_result.status",
            "data_type": "string"
          },
          {
            "data_path": "action_result.message",
            "data_type": "string"
          },
          {
            "data_path": "action_result.parameter.ip_hostname",
            "data_type": "string",
            "contains": [
              "host name"
            ]
          },
          {
            "data_path": "action_result.parameter.machine_name",
            "data_type": "string"
          },
          {
            "data_path": "summary.total_objects",
            "data_type": "numeric"
          },
          {
            "data_path": "summary.total_objects_successful",
            "data_type": "numeric"
          }
        ],
        "versions": "EQ(*)"
      },
      {
        "action": "install updates",
        "description": "Installs the list of updates",
        "verbose": "Triggers the installation command for the provided KB IDs in the endpoint",
        "type": "contain",
        "identifier": "install_updates",
        "read_only": false,
        "lock": {
          "enabled": true,
          "data_path": "parameters.ip_hostname"
        },
        "parameters": {
          "ip_hostname": {
             "data_type": "string",
             "description": "Hostname/IP to install updates on",
             "required": true,
             "order": 0
           },
          "list_of_updates": {
            "data_type": "string",
            "description": "Update KB IDs to install",
            "verbose": "This parameter support a comma separated list. Some examples of Microsoft KB IDs are KB3172605, KB3172605, KB3172605",
            "order": 1,
            "required": true,
            "contains": ["update id"],
            "primary": true
          }
        },
        "render": {
          "width": 12,
          "title": "Install Updates",
          "type": "table",
          "height": 5
        },
        "output": [
          {
            "data_path": "action_result.id",
            "data_type": "string"
          },
          {
            "data_path": "action_result.data",
            "data_type": "string"
          },
          {
            "data_path": "action_result.status",
            "data_type": "string"
          },
          {
            "data_path": "action_result.message",
            "data_type": "string"
          },
          {
            "data_path": "action_result.parameter.ip_hostname",
            "data_type": "string",
            "contains": [
              "host name"
            ]
          },
          {
            "data_path": "action_result.parameter.list_of_updates",
            "data_type": "string"
          },
          {
            "data_path": "summary.total_objects",
            "data_type": "numeric"
          },
          {
            "data_path": "summary.total_objects_successful",
            "data_type": "numeric"
          }
        ],
        "versions": "EQ(*)"
      }
    ]
}
